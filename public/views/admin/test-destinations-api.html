<!DOCTYPE html>
<html>
  <head>
    <title>Test Destinations Load</title>
  </head>
  <body>
    <div id="test-results"></div>

    <script>
      async function testAPI() {
        const results = document.getElementById("test-results");
        results.innerHTML = "<p>Testing API endpoint...</p>";

        try {
          const response = await fetch(
            "./api/destinations.php?action=list&page=1"
          );
          console.log("Response status:", response.status);
          console.log("Response ok:", response.ok);

          if (!response.ok) {
            results.innerHTML += `<p style="color: red;">❌ HTTP Error: ${response.status} ${response.statusText}</p>`;
            return;
          }

          const data = await response.json();
          console.log("API Response:", data);

          if (data.success) {
            results.innerHTML += `<p style="color: green;">✓ API Success!</p>`;
            results.innerHTML += `<p>Destinations loaded: ${data.data.length}</p>`;
          } else {
            results.innerHTML += `<p style="color: orange;">⚠️ API returned success=false</p>`;
            results.innerHTML += `<p>Error: ${
              data.error || "No error message"
            }</p>`;
          }
        } catch (error) {
          console.error("Error:", error);
          results.innerHTML += `<p style="color: red;">❌ Fetch Error: ${error.message}</p>`;
        }
      }

      // Test immediately and every 5 seconds
      testAPI();
      setInterval(testAPI, 5000);
    </script>
  </body>
</html>
