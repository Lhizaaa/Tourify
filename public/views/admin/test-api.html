<!DOCTYPE html>
<html>
  <head>
    <title>Admin API Test</title>
    <style>
      body {
        font-family: Arial;
        margin: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 800px;
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin-top: 20px;
      }
      button {
        padding: 10px 15px;
        margin: 5px;
        cursor: pointer;
      }
      pre {
        background: #222;
        color: #0f0;
        padding: 15px;
        overflow: auto;
        border-radius: 4px;
        font-size: 12px;
      }
      h2 {
        color: #333;
        border-bottom: 2px solid #667eea;
        padding-bottom: 10px;
      }
      .error {
        color: red;
      }
      .success {
        color: green;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Admin API Destination Test</h1>

      <button onclick="testDestinationList()">
        Test Destinations List API
      </button>
      <button onclick="testDestinationDetail()">Test Destination Detail</button>
      <button onclick="testCategories()">Test Categories API</button>

      <div id="result"></div>
    </div>

    <script>
      function testDestinationList() {
        console.log("Testing destinations list...");
        document.getElementById("result").innerHTML = "<p>Loading...</p>";

        fetch("./api/destinations.php?action=list")
          .then((r) => {
            console.log("Response status:", r.status);
            return r.json();
          })
          .then((data) => {
            console.log("API Response:", data);
            let html = "<h2>Destinations List API Response</h2>";

            if (data && data.success) {
              html += '<p class="success">✓ API returned success: true</p>';
              if (data.data && Array.isArray(data.data)) {
                html += `<p>Found ${data.data.length} destinations</p>`;
                if (data.data.length > 0) {
                  html +=
                    "<pre>" + JSON.stringify(data.data[0], null, 2) + "</pre>";
                }
              } else {
                html += '<p class="error">✗ data.data is not an array</p>';
              }
            } else {
              html += '<p class="error">✗ API returned success: false</p>';
              html += "<pre>" + JSON.stringify(data, null, 2) + "</pre>";
            }

            document.getElementById("result").innerHTML = html;
          })
          .catch((err) => {
            console.error("Error:", err);
            document.getElementById("result").innerHTML =
              '<p class="error">✗ Error: ' + err.message + "</p>";
          });
      }

      function testDestinationDetail() {
        console.log("Testing destination detail...");
        document.getElementById("result").innerHTML = "<p>Loading...</p>";

        fetch("./api/destinations.php?action=detail&id=8")
          .then((r) => {
            console.log("Response status:", r.status);
            return r.json();
          })
          .then((data) => {
            console.log("API Response:", data);
            let html = "<h2>Destination Detail API Response</h2>";

            if (data && data.success && data.data) {
              html +=
                '<p class="success">✓ API returned success: true with data</p>';
              html += "<pre>" + JSON.stringify(data.data, null, 2) + "</pre>";
            } else {
              html += '<p class="error">✗ API response invalid</p>';
              html += "<pre>" + JSON.stringify(data, null, 2) + "</pre>";
            }

            document.getElementById("result").innerHTML = html;
          })
          .catch((err) => {
            console.error("Error:", err);
            document.getElementById("result").innerHTML =
              '<p class="error">✗ Error: ' + err.message + "</p>";
          });
      }

      function testCategories() {
        console.log("Testing categories...");
        document.getElementById("result").innerHTML = "<p>Loading...</p>";

        fetch("./api/destinations.php?action=categories")
          .then((r) => {
            console.log("Response status:", r.status);
            return r.json();
          })
          .then((data) => {
            console.log("API Response:", data);
            let html = "<h2>Categories API Response</h2>";

            if (data && data.success && Array.isArray(data.data)) {
              html += `<p class="success">✓ Found ${data.data.length} categories</p>`;
              html += "<pre>" + JSON.stringify(data.data, null, 2) + "</pre>";
            } else {
              html += '<p class="error">✗ API response invalid</p>';
              html += "<pre>" + JSON.stringify(data, null, 2) + "</pre>";
            }

            document.getElementById("result").innerHTML = html;
          })
          .catch((err) => {
            console.error("Error:", err);
            document.getElementById("result").innerHTML =
              '<p class="error">✗ Error: ' + err.message + "</p>";
          });
      }
    </script>
  </body>
</html>
